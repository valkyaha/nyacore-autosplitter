# Dark Souls II: Scholar of the First Sin - Game Data
# Example showing kill counter engine and custom fields

[game]
id = "ds2"
name = "Dark Souls II: Scholar of the First Sin"
short_name = "DS2"
process_names = ["DarkSoulsII.exe"]

[autosplitter]
# DS2 uses kill counters instead of event flags
# Each boss has an offset from the boss counter base address
engine = "ds2_sotfs"

[[autosplitter.patterns]]
name = "game_manager_imp"
pattern = "48 8b 35 ? ? ? ? 48 8b e9 48 85 f6"
resolve = "rip_relative"
rip_offset = 3

[[autosplitter.patterns]]
name = "load_state"
pattern = "48 89 05 ? ? ? ? b0 01 48 83 c4 28"
resolve = "rip_relative"
rip_offset = 3

[autosplitter.pointers]
# Boss kill counters - the core of DS2 autosplitting
boss_counters = { pattern = "game_manager_imp", offsets = [0x0, 0x70, 0xB8, 0x3D8, 0x4A0] }

# Game state for detecting load screens
game_state = { pattern = "game_manager_imp", offsets = [0x0, 0x70, 0x10, 0x28] }

# Player position
position = { pattern = "game_manager_imp", offsets = [0x0, 0x70, 0x10, 0x28, 0x108] }

# In-game time
igt = { pattern = "game_manager_imp", offsets = [0x0, 0x70, 0xB8, 0xD0, 0x24] }

# Loading state
loading = { pattern = "load_state", offsets = [0x11c] }

# ============================================================================
# BOSSES - flag_id is the OFFSET into the boss counter array
# ============================================================================

[[bosses]]
id = "last_giant"
name = "The Last Giant"
flag_id = 0x0
is_dlc = false

[[bosses]]
id = "pursuer"
name = "Pursuer"
flag_id = 0x4
is_dlc = false

[[bosses]]
id = "twin_dragonriders"
name = "Twin Dragonriders"
flag_id = 0x8
is_dlc = false

[[bosses]]
id = "nashendra"
name = "Nashendra"
flag_id = 0xC
is_dlc = false

[[bosses]]
id = "aldia"
name = "Aldia, Scholar of the First Sin"
flag_id = 0x10
is_dlc = false

[[bosses]]
id = "dukes_dear_freja"
name = "The Duke's Dear Freja"
flag_id = 0x14
is_dlc = false

[[bosses]]
id = "lost_sinner"
name = "The Lost Sinner"
flag_id = 0x18
is_dlc = false

[[bosses]]
id = "old_iron_king"
name = "Old Iron King"
flag_id = 0x1C
is_dlc = false

[[bosses]]
id = "dragonrider"
name = "Dragonrider"
flag_id = 0x20
is_dlc = false

[[bosses]]
id = "old_dragonslayer"
name = "Old Dragonslayer"
flag_id = 0x24
is_dlc = false

[[bosses]]
id = "flexile_sentry"
name = "Flexile Sentry"
flag_id = 0x28
is_dlc = false

[[bosses]]
id = "ruin_sentinels"
name = "Ruin Sentinels"
flag_id = 0x2C
is_dlc = false

[[bosses]]
id = "belfry_gargoyles"
name = "Belfry Gargoyles"
flag_id = 0x30
is_dlc = false

[[bosses]]
id = "royal_rat_vanguard"
name = "Royal Rat Vanguard"
flag_id = 0x34
is_dlc = false

[[bosses]]
id = "prowling_magus"
name = "Prowling Magus and Congregation"
flag_id = 0x38
is_dlc = false

[[bosses]]
id = "scorpioness_najka"
name = "Scorpioness Najka"
flag_id = 0x3C
is_dlc = false

[[bosses]]
id = "royal_rat_authority"
name = "Royal Rat Authority"
flag_id = 0x40
is_dlc = false

[[bosses]]
id = "skeleton_lords"
name = "Skeleton Lords"
flag_id = 0x44
is_dlc = false

[[bosses]]
id = "executioners_chariot"
name = "Executioner's Chariot"
flag_id = 0x48
is_dlc = false

[[bosses]]
id = "smelter_demon"
name = "Smelter Demon"
flag_id = 0x50
is_dlc = false

[[bosses]]
id = "mytha"
name = "Mytha, the Baneful Queen"
flag_id = 0x54
is_dlc = false

[[bosses]]
id = "covetous_demon"
name = "Covetous Demon"
flag_id = 0x58
is_dlc = false

[[bosses]]
id = "looking_glass_knight"
name = "Looking Glass Knight"
flag_id = 0x5C
is_dlc = false

[[bosses]]
id = "dragonslayer_armour"
name = "Dragonslayer Armour"
flag_id = 0x60
is_dlc = false

[[bosses]]
id = "demon_of_song"
name = "Demon of Song"
flag_id = 0x64
is_dlc = false

[[bosses]]
id = "giant_lord"
name = "Giant Lord"
flag_id = 0x68
is_dlc = false

[[bosses]]
id = "guardian_dragon"
name = "Guardian Dragon"
flag_id = 0x6C
is_dlc = false

[[bosses]]
id = "darklurker"
name = "Darklurker"
flag_id = 0x70
is_dlc = false

[[bosses]]
id = "vendrick"
name = "Vendrick"
flag_id = 0x74
is_dlc = false

[[bosses]]
id = "velstadt"
name = "Velstadt, the Royal Aegis"
flag_id = 0x78
is_dlc = false

# DLC Bosses
[[bosses]]
id = "fume_knight"
name = "Fume Knight"
flag_id = 0x7C
is_dlc = true

[[bosses]]
id = "elana"
name = "Elana, the Squalid Queen"
flag_id = 0x80
is_dlc = true

[[bosses]]
id = "sinh"
name = "Sinh, the Slumbering Dragon"
flag_id = 0x84
is_dlc = true

[[bosses]]
id = "afflicted_graverobber"
name = "Afflicted Graverobber, Ancient Soldier Varg, and Cerah the Old Explorer"
flag_id = 0x88
is_dlc = true

[[bosses]]
id = "sir_alonne"
name = "Sir Alonne"
flag_id = 0x8C
is_dlc = true

[[bosses]]
id = "blue_smelter_demon"
name = "Blue Smelter Demon"
flag_id = 0x90
is_dlc = true

[[bosses]]
id = "aava"
name = "Aava, the King's Pet"
flag_id = 0x94
is_dlc = true

[[bosses]]
id = "burnt_ivory_king"
name = "Burnt Ivory King"
flag_id = 0x9C
is_dlc = true

[[bosses]]
id = "lud_and_zallen"
name = "Lud and Zallen, the King's Pets"
flag_id = 0xA0
is_dlc = true

# ============================================================================
# CUSTOM FIELDS - DS2-specific features
# ============================================================================

[custom_fields.kill_count]
type = "integer"
default = 1
min = 1
max = 99
description = "Number of times to kill this boss (for Bonfire Ascetic runs)"
applies_to = "boss"
# When kill_count > 1, the autosplitter will:
# 1. Read the actual kill counter value from memory
# 2. Only trigger when kill_count reaches the target value
# This enables runs like "All Bosses x2" or specific ascetic routing

# ============================================================================
# PRESETS
# ============================================================================

[[presets]]
id = "any-percent"
name = "Any%"
description = "Beat the game as fast as possible"
bosses = [
    "last_giant",
    "pursuer",
    "dragonrider",
    "old_dragonslayer",
    "flexile_sentry",
    "lost_sinner",
    "skeleton_lords",
    "covetous_demon",
    "mytha",
    "smelter_demon",
    "old_iron_king",
    "scorpioness_najka",
    "dukes_dear_freja",
    "looking_glass_knight",
    "demon_of_song",
    "velstadt",
    "vendrick",
    "guardian_dragon",
    "giant_lord",
    "twin_dragonriders",
    "nashendra",
    "aldia"
]

[[presets]]
id = "all-bosses"
name = "All Bosses"
description = "Defeat every boss including optional and DLC"
bosses = [
    "last_giant",
    "pursuer",
    "dragonrider",
    "flexile_sentry",
    "ruin_sentinels",
    "lost_sinner",
    "belfry_gargoyles",
    "skeleton_lords",
    "executioners_chariot",
    "covetous_demon",
    "mytha",
    "old_iron_king",
    "smelter_demon",
    "old_dragonslayer",
    "scorpioness_najka",
    "royal_rat_authority",
    "prowling_magus",
    "dukes_dear_freja",
    "royal_rat_vanguard",
    "looking_glass_knight",
    "demon_of_song",
    "velstadt",
    "vendrick",
    "guardian_dragon",
    "darklurker",
    "dragonslayer_armour",
    "giant_lord",
    "twin_dragonriders",
    "nashendra",
    "aldia",
    # DLC
    "elana",
    "sinh",
    "afflicted_graverobber",
    "fume_knight",
    "sir_alonne",
    "blue_smelter_demon",
    "aava",
    "burnt_ivory_king",
    "lud_and_zallen"
]

# ============================================================================
# ATTRIBUTES
# ============================================================================

[[attributes]]
id = "soul_level"
name = "Soul Level"
offset = 0xD0

[[attributes]]
id = "vigor"
name = "Vigor"
offset = 0x0

[[attributes]]
id = "endurance"
name = "Endurance"
offset = 0x2

[[attributes]]
id = "vitality"
name = "Vitality"
offset = 0x4

[[attributes]]
id = "attunement"
name = "Attunement"
offset = 0x6

[[attributes]]
id = "strength"
name = "Strength"
offset = 0x8

[[attributes]]
id = "dexterity"
name = "Dexterity"
offset = 0xA

[[attributes]]
id = "adaptability"
name = "Adaptability"
offset = 0xC

[[attributes]]
id = "intelligence"
name = "Intelligence"
offset = 0xE

[[attributes]]
id = "faith"
name = "Faith"
offset = 0x10
